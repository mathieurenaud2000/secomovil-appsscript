<style>
    :root{
      --fix: 1;
      --gap: 12px;
      --radius: 40px;
      --font-label: 12px;
      --font-small: 14px;
      --font-body: 15px;
      --btn-fs: 16px;
      --btn-ph: 14px;
      --btn-pw: 18px;
      --btn-minh: 48px;
      --black: #000;
      --white: #fff;
      --gray10: rgba(0,0,0,0.10);
      --gray20: rgba(0,0,0,0.20);
      --gray25: rgba(0,0,0,0.25);
    }

    html, body{
      margin:0; padding:0;
      width:100%; max-width:100%;
      overflow-x:hidden; box-sizing:border-box;
      background:#fff;
      font-family: Roboto, system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
    }
    *, *::before, *::after{ box-sizing:inherit; }
    *:focus{ outline:none!important; box-shadow:none!important; }

    .wrapper{ padding: 0 50px; }

    .sep-black{ height:0; border-top: 5px solid var(--black); }
    .sep-gray { height:0; border-top: 2px solid var(--gray20); }

    /* ===== HEADER ===== */
    .header{
      display:block;
      margin: calc(var(--gap) * var(--fix)) 0 0 0; /* top 12px, bottom 0 */
    }
    .header-logo{ display:block; width:100%; line-height:0; margin:0; }
    .header-img{
      display:block; width:100%; height:auto;
      object-fit:contain; object-position:left center;
      margin:0 8px 15px 0;
      padding-bottom:30px;
    }

    .header-grid{
      display:grid;
      grid-template-columns: 1fr auto;
      align-items:end;
      padding: calc(12px * var(--fix)) 0;
    }
    .header-title{
      text-transform: uppercase; font-weight: 900;
      font-size: calc(21px * var(--fix));
      line-height: calc(20px * var(--fix));
    }
    .header-title span{ display:block; }

    .header-id{
      text-align:right;
      font-size: calc(10px * var(--fix));
      color:#111;
      white-space:nowrap;
    }

    .pedido-id-loader{
      display:inline-flex;
      align-items:flex-end;
      justify-content:flex-end;
      gap: calc(3px * var(--fix));
      min-width: calc(64px * var(--fix));
      height: calc(12px * var(--fix));
    }
    .pedido-id-loader .dot{
      width: calc(5px * var(--fix));
      height: calc(5px * var(--fix));
      border-radius:50%;
      background:#111;
      opacity:0.3;
      animation: pedidoIdPulse 1s infinite ease-in-out;
    }
    .pedido-id-loader .dot:nth-child(2){ animation-delay:0.15s; }
    .pedido-id-loader .dot:nth-child(3){ animation-delay:0.30s; }

    @keyframes pedidoIdPulse{
      0%, 80%, 100%{ opacity:0.25; transform: translateY(0); }
      40%{ opacity:0.8; transform: translateY(-1px); }
    }

    /* STACK */
    .stack{
      display:flex;
      flex-direction:column;
      gap: calc(var(--gap) * var(--fix));
    }

    /* ===== DROPDOWN (styleguide-like, SANS BORDURE) ===== */
    .dropdown{
      position:relative; width:100%;
      font-size: calc(var(--font-body) * var(--fix)); /* facteur OK */
    }

    /* Variante PLAIN (sans bordure, même logique que le styleguide) */
    .dropdown[data-variant="plain"] .dd-button{
      border: 0;
      border-radius: 0;
      background:#fff; color:#000;
      padding: 0 calc(36px * var(--fix)) 0 0;
      height: calc(44px * var(--fix));
      display:flex; align-items:center;
      margin-top:0; margin-bottom:0;
    }

    /* ZÉRO GAP autour des menus sans cadre (exactement comme le styleguide) */
    .sep-black + .dropdown[data-variant="plain"],
    .sep-gray  + .dropdown[data-variant="plain"]{
      margin-top: calc(-12px * var(--fix));
    }
    .dropdown[data-variant="plain"] + .sep-black,
    .dropdown[data-variant="plain"] + .sep-gray{
      margin-top: calc(-12px * var(--fix));
    }

    .dd-button{
      width:100%; text-align:left; position:relative; cursor:pointer;
      line-height:1.3; font-size: inherit;
    }
    .dd-button[data-placeholder="true"] .dd-label{ color: var(--gray25); }
    .dd-label{ display:block; padding-right: calc(18px * var(--fix)); }
    .dd-caret{
      position:absolute; right: calc(16px * var(--fix)); top:50%; transform: translateY(-50%);
      width:0; height:0; pointer-events:none;
      border-left: calc(6px * var(--fix)) solid transparent;
      border-right: calc(6px * var(--fix)) solid transparent;
      border-top: calc(6px * var(--fix)) solid #000;
    }

    /* OVERLAY LIST */
    .dd-overlay{
      position:fixed; inset:0; background:#fff; display:none; z-index:1000;
      overflow:auto;
    }
    .dd-overlay[data-open="true"]{ display:block; }

    .dd-overlay-list{
      list-style:none; margin:0; padding:0;
      font-size: calc(var(--font-body) * var(--fix));
    }
    .dd-overlay-option{
      padding: calc(12px * var(--fix)) calc(10px * var(--fix));
      border-bottom:2px solid var(--gray20);
      cursor:pointer;
    }

    /* BUTTONS */
    .btn{
      display:block; width:100%;
      text-transform:uppercase; font-weight:700;
      font-size: calc(var(--btn-fs) * var(--fix));
      padding: calc(var(--btn-ph) * var(--fix)) calc(var(--btn-pw) * var(--fix));
      min-height: calc(var(--btn-minh) * var(--fix));
      border-radius: var(--radius);
      border:5px solid transparent;
      transition:0.15s ease;
    }

    .btn-noir{
      background:#000; color:#fff; border-color:#000;
      box-shadow:0 20px 40px rgba(0,0,0,0.40);
    }

    .btn-desactive{
      background: var(--gray10);
      color:#fff;
      border:0;
      box-shadow:none;
      cursor:default;
    }

    .btn-blanc{
      background:#fff; color:#000; border-color: var(--gray20);
    }
    .btn-blanc:active{
      color: rgba(0,0,0,0.5);
    }
  </style>
<div class="wrapper">

    <!-- HEADER -->
    <header class="header">
      <div class="header-logo">
        <img class="header-img" id="headerImg"
             src="https://lh3.googleusercontent.com/d/15N5N0TgMBTxmn2v-sKsG53mEAKaxXYtA"
             alt="Logo SecoMobil">
      </div>

      <div class="sep-black"></div>

      <div class="header-grid">
        <div class="header-title">
          <span>NUEVO</span>
          <span>PEDIDO</span>
        </div>
        <div class="header-id" id="pedidoIdHeader">
          <span id="pedidoIdTexto" style="display:none;"></span>
          <span class="pedido-id-loader" aria-label="Cargando ID" role="status">
            <span class="dot"></span>
            <span class="dot"></span>
            <span class="dot"></span>
          </span>
        </div>
      </div>
    </header>

    <!-- CONTENU -->
    <div class="stack">

      <!-- SÉPARATEUR NOIR EXACTEMENT AVANT LE MENU -->
      <div class="sep-black"></div>

      <!-- MENU DÉROULANT SANS BORDURE (VARIANTE PLAIN) -->
      <div class="dropdown" data-variant="plain">
        <button type="button" class="dd-button" id="contactBtn" data-placeholder="true">
          <span class="dd-label">Elegir un contacto</span><span class="dd-caret"></span>
        </button>
        <script type="application/json" class="dd-data">[]</script>
      </div>

      <!-- SÉPARATEUR GRIS DIRECTEMENT APRÈS -->
      <div class="sep-gray"></div>

      <!-- ESPACE AVANT LE BOUTON OK -->
      <div style="height: calc(24px * var(--fix));"></div>

      <!-- BOUTONS -->
      <button class="btn btn-desactive" id="btnOK" disabled>OK</button>
      <button class="btn btn-blanc" id="btnVolverInicio">VOLVER AL INICIO</button>

      <div style="height:0;"></div>
    </div>
  </div>

  <!-- OVERLAY -->
  <div class="dd-overlay" id="ddOverlay">
    <ul class="dd-overlay-list" id="ddOverlayList"></ul>
  </div>

  <script>
    function setPedidoIdHeader(texto){
      var contenedor = document.getElementById('pedidoIdHeader');
      var campoTexto = contenedor ? contenedor.querySelector('#pedidoIdTexto') : null;
      var loader = contenedor ? contenedor.querySelector('.pedido-id-loader') : null;

      if (!contenedor) return;

      var valor = (texto || '').toString().trim();
      var tieneValor = !!valor;

      if (campoTexto){
        campoTexto.textContent = valor;
        campoTexto.style.display = tieneValor ? '' : 'none';
      } else {
        contenedor.textContent = valor || '—';
      }

      if (loader){
        loader.style.display = tieneValor ? 'none' : '';
      }
    }

    function cargarNuevoPedidoId(){
      if (!(window.google && google.script && google.script.run)){
        setPedidoIdHeader('');
        return;
      }

      google.script.run
        .withSuccessHandler(function(resp){
          if (resp && resp.ok && resp.data && resp.data.idPedido){
            setPedidoIdHeader(resp.data.idPedido);
          } else {
            setPedidoIdHeader('');
          }
        })
        .withFailureHandler(function(){
          setPedidoIdHeader('');
        })
        .initNuevoPedido();
    }

    if (document.readyState === 'loading'){
      document.addEventListener('DOMContentLoaded', cargarNuevoPedidoId);
    } else {
      cargarNuevoPedidoId();
    }
  </script>
