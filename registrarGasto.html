  <style>
    :root{
      --fix: 1;
      --gap: 12px;
      --radius: 40px;
      --font-label: 12px;
      --font-small: 14px;
      --font-body: 15px;
      --btn-fs: 16px;
      --btn-ph: 14px;
      --btn-pw: 18px;
      --btn-minh: 48px;
      --black: #000;
      --white: #fff;
      --gray05: rgba(0,0,0,0.05);
      --gray10: rgba(0,0,0,0.10);
      --gray15: rgba(0,0,0,0.15);
      --gray20: rgba(0,0,0,0.20);
      --gray25: rgba(0,0,0,0.25);
    }

    html, body{
      margin:0; padding:0;
      width:100%; max-width:100%;
      overflow-x:hidden; box-sizing:border-box;
      background:#fff;
      font-family: Roboto, system-ui, -apple-system, "Segoe UI", Arial, sans-serif;
    }
    *, *::before, *::after{ box-sizing:inherit; }
    *:focus{ outline:none!important; box-shadow:none!important; }

    .wrapper{ padding: 0 50px; }

    /* ===== ENTÊTE ===== */
    .header{ display:block; margin: calc(var(--gap) * var(--fix)) 0 0 0; }
    .header-logo{ display:block; width:100%; line-height:0; margin:0; }
    .header-img{
      display:block; width:100%; height:auto;
      object-fit:contain; object-position:left center;
      margin:0 8px 15px 0;
      padding-bottom:30px;
    }

    .sep-black{ height:0; border-top: 5px solid var(--black); }
    .sep-gray { height:0; border-top: 2px solid var(--gray20); }

    .header-grid{
      display:grid; grid-template-columns: 1fr;
      align-items:end;
      gap: calc(8px * var(--fix));
      padding: calc(12px * var(--fix)) 0;
      text-align:left;
    }
    .header-title{
      text-transform: uppercase; font-weight: 900;
      font-size: calc(21px * var(--fix));
      line-height: calc(20px * var(--fix));
    }
    .header-title span{ display:block; }

    /* ===== BOUTONS ===== */
    .btn{
      display:block; width:100%;
      text-transform:uppercase; font-weight:700;
      font-size: calc(var(--btn-fs) * var(--fix)); line-height:1.2;
      padding: calc(var(--btn-ph) * var(--fix)) calc(var(--btn-pw) * var(--fix));
      min-height: calc(var(--btn-minh) * var(--fix));
      border-radius: var(--radius);
      border: 5px solid transparent; cursor:pointer;
      transition: filter .15s ease, background .15s ease, color .15s ease, border-color .15s ease;
    }
    .btn:active{ filter:brightness(0.95); }

    .btn-noir{
      background:#000; color:#fff; border-color:#000;
      box-shadow:0 20px 40px rgba(0,0,0,0.40);
    }
    .btn-blanc{
      background:#fff; color:#000; border-color: var(--gray20);
    }
    .btn-blanc:active{
      color: rgba(0,0,0,0.5);
    }
    .btn[disabled]{
      opacity:0.6;
      box-shadow:none;
      cursor:not-allowed;
    }

    .stack{
      display:flex; flex-direction:column;
      gap: calc(var(--gap) * var(--fix));
    }

    .loading-block{
      display:flex;
      flex-direction:column;
      gap: calc(6px * var(--fix));
      margin-top: calc(12px * var(--fix));
    }

    .txt-mini{
      font-size: calc(var(--font-label) * var(--fix));
      color:#111;
    }
    .txt-small{
      font-size: calc(var(--font-small) * var(--fix));
      color:#111;
    }

    /* ===== LABELS ===== */
    .label{
      font-size: calc(var(--font-small) * var(--fix));
      color:#000;
      font-weight:500;
    }
    .label .opt{ color: var(--gray25); }

    .form-section{ display:flex; flex-direction:column; gap: calc(6px * var(--fix)); }
    .form-section.first-dropdown{ margin-top: calc(12px * var(--fix)); }
    #sectionProducto{ margin-top: calc(var(--gap) * var(--fix)); }
    #sepAfterProducto{ margin: calc(var(--gap) * var(--fix)) 0; }
    #sectionUnidad{ margin-top: calc(var(--gap) * var(--fix)); }
    #sepBeforeCosto{ margin: calc(var(--gap) * var(--fix)) 0; }
    #sepAfterCosto{ margin: calc(var(--gap) * var(--fix)) 0; }
    #sectionObservaciones{ margin: calc(var(--gap) * var(--fix)) 0; }
    #sepBeforeButtons{ margin: calc(var(--gap) * var(--fix)) 0; }

    /* ===== CHAMP TEXTE MULTI-LIGNES ===== */
    .field-multi{
      width:100%;
      min-height: calc(60px * var(--fix));
      border-radius: var(--radius);
      border:5px solid var(--gray20);
      font-size: calc(var(--font-body) * var(--fix));
      padding: calc(10px * var(--fix)) calc(12px * var(--fix));
      resize: vertical;
    }

    /* ===== DROPDOWN ===== */
    .dropdown{
      position:relative; width:100%;
      font-size: calc(var(--font-body) * var(--fix));
    }
    .dropdown[data-variant="boxed"] .dd-button{
      border: 5px solid var(--black);
      border-radius: var(--radius);
      background:#fff; color:#000;
      padding: calc(10px * var(--fix)) calc(36px * var(--fix)) calc(10px * var(--fix)) calc(10px * var(--fix));
    }

    .dd-button{
      width:100%; text-align:left; position:relative; cursor:pointer;
      line-height:1.3; font-size: inherit;
    }
    .dd-button[disabled]{ cursor:not-allowed; }
    .dd-button[data-placeholder="true"] .dd-label{ color: var(--gray25); }
    .dd-label{ display:block; padding-right: calc(18px * var(--fix)); }
    .dd-spinner-wrap{
      position:absolute;
      left: calc(10px * var(--fix));
      right: calc(36px * var(--fix));
      top:50%;
      transform:translateY(-50%);
      display:none;
      align-items:center;
      justify-content:flex-start;
      pointer-events:none;
    }
    .dd-button.dd-loading .dd-label{ visibility:hidden; }
    .dd-button.dd-loading .dd-spinner-wrap{ display:flex; }
    .dd-dots{
      display:inline-flex;
      align-items:center;
      gap: calc(4px * var(--fix));
    }
    .dd-dot{
      width: calc(6px * var(--fix));
      height: calc(6px * var(--fix));
      border-radius:50%;
      background:var(--black);
      opacity:.35;
      animation: dd-dot-bounce 1s ease-in-out infinite;
    }
    .dd-dot:nth-child(2){ animation-delay:.16s; }
    .dd-dot:nth-child(3){ animation-delay:.32s; }
    @keyframes dd-dot-bounce{
      0%, 80%, 100%{ transform:translateY(0); opacity:.35; }
      40%{ transform:translateY(calc(-3px * var(--fix))); opacity:1; }
    }
    .dd-caret{
      position:absolute; right: calc(16px * var(--fix)); top:50%; transform: translateY(-50%);
      width: 0; height: 0; pointer-events:none;
      border-left: calc(6px * var(--fix)) solid transparent;
      border-right: calc(6px * var(--fix)) solid transparent;
      border-top: calc(6px * var(--fix)) solid #000;
    }

    /* OVERLAY LISTE */
    .dd-overlay{
      position: fixed;
      inset: 0;
      background:#fff;
      display:none;
      z-index: 2147483647;
      overflow:auto;
      pointer-events:auto;
      isolation:isolate;
    }
    .dd-overlay[data-open="true"]{ display:block; }
    .dd-overlay-inner{
      position:relative;
      z-index:1;
      max-width:100%;
      padding-top: 0;
      pointer-events:none;
    }
    .dd-overlay-inner::before,
    .dd-overlay-inner::after{
      pointer-events:none;
    }
    .dd-overlay-list{
      position:relative;
      z-index:2;
      list-style:none; margin:0; padding:0;
      font-size: calc(var(--font-body) * var(--fix));
      pointer-events:auto;
    }
    .dd-overlay-option{
      position:relative;
      z-index:3;
      padding: calc(12px * var(--fix)) calc(10px * var(--fix));
      border-bottom: 2px solid var(--gray20);
      line-height:1.25; cursor:pointer;
      pointer-events:auto;
    }

    body.dd-open .wrapper{
      pointer-events:none;
    }

    body.dd-open #ddOverlay,
    body.dd-open #ddOverlay *{
      pointer-events:auto;
    }
    .dd-overlay-option.placeholder{ color: var(--gray25); }

    /* ===== CARTE DÉPENSE ===== */
    .expense-card{
      position:relative;
      border-radius: var(--radius);
      border:5px solid #000;
      background:#fff;
      padding:0;
      display:flex;
      flex-direction:column;
      overflow:hidden;
      min-height: calc(146px * var(--fix));
    }

    .expense-card-loading{
      position:absolute;
      inset:0;
      display:none;
      align-items:center;
      justify-content:center;
      pointer-events:none;
      background:#fff;
      z-index:2;
    }
    .expense-card-loading .dd-dots{
      gap: calc(6px * var(--fix));
    }
    .expense-card-loading .dd-dot{
      width: calc(9px * var(--fix));
      height: calc(9px * var(--fix));
    }
    .expense-card.is-loading .expense-card-loading{
      display:flex;
    }
    .expense-card.is-loading .expense-card-content{
      visibility:hidden;
    }

    .exp-row1{
      display:grid;
      grid-template-columns: 45% auto 1fr; /* 1re colonne à 45% */
      align-items:flex-start;
      border-bottom:2px solid var(--gray20);
      padding:0;
    }
    .exp-qty-wrap{
      padding: calc(15px * var(--fix));
    }
    .exp-qty-input{
      width:100%;
      border-radius:0;
      border:2px solid var(--gray20);
      background:#fff;
      font-size: calc(var(--font-body) * var(--fix));
      padding: calc(8px * var(--fix)) calc(6px * var(--fix));
      text-align:center; /* contenu centré */
    }
    .exp-unit{
      padding: 0 0 calc(12px * var(--fix)) 0; /* padding-left 0px */
      align-self:flex-end;
      display:flex;
      align-items:flex-end;
      font-size: calc(var(--font-label) * var(--fix)); /* texte mini */
    }
    .exp-unit span{
      display:inline-block;
    }
    .exp-edit{
      padding: calc(15px * var(--fix)) calc(15px * var(--fix)) 0 0;
      display:flex;
      justify-content:flex-end;
    }
    .exp-edit img{
      display:block;
      width: calc(18px * var(--fix));
      height:auto;
      object-fit:contain;
      opacity:0.45;
    }

    .exp-row2{
      padding: calc(15px * var(--fix));
      font-size: calc(var(--font-small) * var(--fix));
      color: var(--gray25);
    }

    .exp-row3{
      display:grid;
      grid-template-columns: auto 1fr;
      align-items:flex-end;
      padding:0;
    }
    .exp-label{
      padding: 0 0 calc(15px * var(--fix)) calc(15px * var(--fix));
      font-size: calc(var(--font-label) * var(--fix));
    }
    .exp-total{
      padding: 0 calc(15px * var(--fix)) calc(12px * var(--fix)) 0; /* bas 10px */
      text-align:right;
      font-size: calc(24px * var(--fix));
      font-weight:400;
    }

  </style>
</head>
<body>
  <div class="wrapper">

    <!-- ENTÊTE -->
    <header class="header">
      <div class="header-logo">
        <img class="header-img" id="headerImg"
             src="https://lh3.googleusercontent.com/d/15N5N0TgMBTxmn2v-sKsG53mEAKaxXYtA"
             alt="Logo SecoMobil">
      </div>

      <div class="sep-black"></div>

      <div class="header-grid">
        <div class="header-title">
          <span>REGISTRAR</span>
          <span>GASTO</span>
        </div>
      </div>

      <div class="sep-black"></div>
    </header>

    <!-- CONTENU -->
    <div class="stack">

      <div id="registrarGastoLoading" class="loading-block">
        <div class="dropdown" data-variant="boxed" data-ph="Categoría" data-value="">
          <button type="button" class="dd-button dd-loading" data-placeholder="true" disabled aria-busy="true">
            <span class="dd-label">Categoría</span><span class="dd-spinner-wrap" aria-hidden="true"><span class="dd-dots"><span class="dd-dot"></span><span class="dd-dot"></span><span class="dd-dot"></span></span></span><span class="dd-caret" aria-hidden="true"></span>
          </button>
        </div>
      </div>

      <div id="registrarGastoFields" style="display:none;">

      <!-- Catégorie -->
      <div class="form-section first-dropdown" id="sectionCategoria">
        <div class="dropdown" data-variant="boxed" data-ph="Categoría" data-value="">
          <button type="button" class="dd-button" data-placeholder="true">
            <span class="dd-label">Categoría</span><span class="dd-spinner-wrap" aria-hidden="true"><span class="dd-dots"><span class="dd-dot"></span><span class="dd-dot"></span><span class="dd-dot"></span></span></span><span class="dd-caret" aria-hidden="true"></span>
          </button>
          <script type="application/json" class="dd-data">[]</script>
        </div>
      </div>

      <!-- Produit -->
      <div class="form-section" id="sectionProducto" style="display:none;">
        <div class="dropdown" data-variant="boxed" data-ph="Producto" data-value="">
          <button type="button" class="dd-button" data-placeholder="true">
            <span class="dd-label">Producto</span><span class="dd-spinner-wrap" aria-hidden="true"><span class="dd-dots"><span class="dd-dot"></span><span class="dd-dot"></span><span class="dd-dot"></span></span></span><span class="dd-caret" aria-hidden="true"></span>
          </button>
          <script type="application/json" class="dd-data">[]</script>
        </div>
      </div>

      <div class="sep-gray" id="sepAfterProducto" style="display:none;"></div>

      <!-- Fournisseur -->
      <div class="form-section" id="sectionProveedor" style="display:none;">
        <div class="label">Proveedor</div>
        <div class="dropdown" data-variant="boxed" data-ph="Proveedor" data-value="">
          <button type="button" class="dd-button" data-placeholder="true">
            <span class="dd-label">Proveedor</span><span class="dd-spinner-wrap" aria-hidden="true"><span class="dd-dots"><span class="dd-dot"></span><span class="dd-dot"></span><span class="dd-dot"></span></span></span><span class="dd-caret" aria-hidden="true"></span>
          </button>
          <script type="application/json" class="dd-data">[]</script>
        </div>
      </div>

      <!-- Unidad -->
      <div class="form-section" id="sectionUnidad" style="display:none;">
        <div class="label">Unidad</div>
        <div class="dropdown" data-variant="boxed" data-ph="Unidad" data-value="">
          <button type="button" class="dd-button" data-placeholder="true">
            <span class="dd-label">Unidad</span><span class="dd-spinner-wrap" aria-hidden="true"><span class="dd-dots"><span class="dd-dot"></span><span class="dd-dot"></span><span class="dd-dot"></span></span></span><span class="dd-caret" aria-hidden="true"></span>
          </button>
          <script type="application/json" class="dd-data">[]</script>
        </div>
      </div>

      <div class="sep-gray" id="sepBeforeCosto" style="display:none;"></div>

      <div id="registrarCostoContainer" class="stack" style="display:none;">
        <button class="btn btn-blanc" id="btnRegistrarCostoCta">REGISTRAR UN COSTO</button>
      </div>

      <!-- CARTE DÉPENSE -->
      <div id="precioUnitarioContainer" style="display:none;">
      <div class="expense-card" id="expenseCard" data-unit-label="Lb" data-unit-price="1.75">
        <div class="expense-card-loading" id="expenseCardLoading" aria-hidden="true">
          <span class="dd-dots"><span class="dd-dot"></span><span class="dd-dot"></span><span class="dd-dot"></span></span>
        </div>
        <div class="expense-card-content" id="expenseCardContent">
        <!-- Ligne 1 -->
        <div class="exp-row1">
          <div class="exp-qty-wrap">
            <input type="number" min="0" step="0.01" inputmode="decimal"
                   class="exp-qty-input" id="qtyInput" placeholder="">
          </div>
          <div class="exp-unit">
            <span id="unitLabel">Lb</span>
          </div>
          <div class="exp-edit">
            <img src="https://lh3.googleusercontent.com/d/1IJOPYYBICvweVK9rn2mQqckhfyQOHvrJ" alt="Éditer">
          </div>
        </div>

        <!-- Ligne 2 -->
        <div class="exp-row2">
          <span id="unitPriceText">1,75 $ / libra</span>
        </div>

        <!-- Ligne 3 -->
        <div class="exp-row3">
          <div class="exp-label">Gasto</div>
          <div class="exp-total" id="expenseTotal">0,00 $</div>
        </div>
        </div>
      </div>
      </div>

      <div class="sep-gray" id="sepAfterCosto" style="display:none;"></div>

      <!-- Observations -->
      <div class="form-section" id="sectionObservaciones" style="display:none;">
        <div class="label">Observaciones <span class="opt">(Opcional)</span></div>
        <textarea class="field-multi" id="obsField"></textarea>
      </div>

      <div class="sep-gray" id="sepBeforeButtons" style="display:none;"></div>

      <!-- Boutons -->
      <button class="btn btn-noir" id="btnRegistrar" disabled style="display:none;">REGISTRAR</button>
      </div>

      <button class="btn btn-blanc" data-role="volver-inicio">VOLVER AL INICIO</button>

      <div style="height: calc(24px * var(--fix));"></div>
    </div>
  </div>

  <!-- OVERLAY GLOBAL DROPDOWNS -->
  <div class="dd-overlay" id="ddOverlay" aria-hidden="true">
    <div class="dd-overlay-inner" id="ddOverlayInner">
      <ul class="dd-overlay-list" id="ddOverlayList" role="listbox" aria-label="Options"></ul>
    </div>
  </div>
